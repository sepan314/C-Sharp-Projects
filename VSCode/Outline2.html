<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <title>Document 2</title>
</head>
<style>
    tbody tr {
        cursor: pointer;
    }

    tbody tr span:hover {
        box-shadow: 0 0 4px 1px rgba(0, 0, 0, 0.5);

    }

    tr.isviewed-false {
        font-weight: bold;
    }

    #inboxDetails {
        display: none;
    }
</style>

<body>
    <br><br>
    <div class="container">
        <!-- Nav tabs justify-content-between"-->
        <ul class="nav nav-tabs justify-content-end" role="tablist">
            <li class="nav-item mr-auto">
                <a class="nav-link btn btn-primary" data-toggle="tab" href="#newMsg">Compose</a>
            </li>

            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#inbox">Inbox</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#">Sent</a>
            </li>

        </ul>

        <!-- Tab panes -->
        <div class="tab-content border">
            <!-- Compose/New Message tab -->
            <div id="newMsg" class="container tab-pane fade my-4 text-right">
                <form class="form">
                    <div class="form-group row">
                        <label class="col-lg-2 col-md-2 control-label col-1" for="toField">To:</label>
                        <div class="col-lg-6 col-md-8">
                            <input id="toField" name="toField" type="text" placeholder="" class="form-control">

                        </div>
                    </div>

                    <div class="form-group row">
                        <label class="col-lg-2 col-md-2 control-label col-1" for="subjectField">Subject:</label>
                        <div class="col-lg-6 col-md-8">
                            <input id="subjectField" name="subjectField" type="text" placeholder="" class="form-control"
                                autocomplete="off">

                        </div>
                    </div>

                    <div class="form-group row">
                        <label class="col-lg-2 col-md-2 control-label col-1" for="bodyField">Body:</label>
                        <div class="col-lg-6 col-md-8">
                            <textarea rows="5" class="form-control" id="bodyField" name="bodyField"
                                style="resize: vertical;"></textarea>
                        </div>
                    </div>

                    <div class="form-group row">
                        <div class="col-lg-8 col-md-10">
                            <button type="submit" class="btn btn-primary">Send</button>
                            <button type="reset" class="btn btn-danger"><i class="fa fa-trash"
                                    aria-hidden="true"></i></button>
                        </div>
                    </div>

                </form>

            </div>

            <!-- Inbox tab -->
            <div id="inbox" class="container tab-pane active my-4">
                <!-- this div will be hid/shown upon clicking a msg -->
                <div id="inboxList">
                    <table class="table table-hover">
                        <thead>
                            <tr class="d-flex">
                                <th class="col-2">From</th>
                                <th class="col-5">Subject</th>
                                <th class="col-2 d-none">Body</th>
                                <th class="col-2">Date</th>
                                <th class="col-3 col-lg-2" id="badges"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- for loop for all items in model -->
                            <!-- parentId is for future feature, isviewed-false is only present if isviewed is null-->
                            <!-- could use data- attributes to store info, js: use .data() to retrieve value -->
                            <tr class="d-flex inboxRow parentId-0" data-msg_id="1">
                                <td class="col-2 msgFrom">Admin</td>
                                <td class="col-5 msgSubject">Lorem ipsum.</td>
                                <td class="col-2 msgDate">6/10/20 10:30PM</td>
                                <td class="col-2 d-none msgBody">
                                    Ut enim ad
                                </td>
                                <td class="col-3 col-lg-2"><span
                                        class="badge badge-pill badge-secondary mx-2 list-reply">Reply</span><span
                                        class="badge badge-pill badge-danger list-del"><i class="fa fa-trash"
                                            aria-hidden="true"></i></span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </div>
                <!-- on load, this will be a template with no data, click of a msg will populate the template with the msg info and be displayed  -->
                <!-- current html is dummy data / form-control-plaintext -->
                <div id="inboxDetails" data-msg_id="1">
                    <!-- add heading later "Message ID int" -->
                    <h5 class="text-center my-2">Message</h5>
                    <form class="form">
                        <div class="form-group row align-items-center">
                            <label class="col-lg-2 col-md-2 control-label col-1 text-right">From:</label>
                            <div class="col-lg-6 col-md-8 msgFrom"></div>
                        </div>

                        <div class=" form-group row align-items-center">
                            <label class="col-lg-2 col-md-2 control-label col-1 text-right">Date:</label>
                            <div class="col-lg-3 col-md-4 msgDate"></div>
                        </div>

                        <div class="form-group row align-items-center">
                            <label class="col-lg-2 col-md-2 control-label col-1 text-right">Subject:</label>
                            <p class="col-lg-6 col-md-8 msgSubject"></p>
                        </div>

                        <div class="form-group row align-items-center">
                            <label class="col-lg-2 col-md-2 control-label col-1 text-right">Body:</label>
                            <div class="col-lg-6 col-md-8 msgBody"></div>
                        </div>


                        <div class="form-group row align-items-center">
                            <label class="col-lg-2 col-md-2 control-label col-1"></label>
                            <div class="col-lg-6 col-md-8 clearfix text-right">
                                <button type="button" id="goback" class="btn btn-info float-left">Go
                                    Back</button>
                                <button type="button" id="reply" class="btn btn-success mx-1">Reply</button>
                                <button type="button" id="delete" class="btn btn-danger"><i class="fa fa-trash"
                                        aria-hidden="true"></i></button>


                            </div>
                        </div>

                    </form>

                </div>
            </div>

            <!-- sent tab -->
        </div>
    </div>

    <script>
        $(document).ready(function () {
            //behavior of row in inboxList tab
            $(".inboxRow").on("click", "td:not(:last-child)", function () {
                var msgId_str = $(this).parent().data("msg_id");
                console.log("msgId: " + msgId_str + ", type: " + typeof (msgId_str));
                if ($(this).parent().hasClass("isviewed-false")) {
                    //ajax post and update isviewed to current date time, success - change
                    $(this).parent().css("font-weight", "normal");
                    $(this).parent().removeClass(".isviewed-false");
                }
                $("#inboxList").hide();
                $("#inboxDetails .msgFrom").html($(this).parent().find(".msgFrom").html());
                $("#inboxDetails .msgDate").html($(this).parent().find(".msgDate").html());
                $("#inboxDetails .msgSubject").html($(this).parent().find(".msgSubject").html());
                $("#inboxDetails .msgBody").html("<textarea rows='5' class='form-control' style='resize:none;' readonly>" + $(this).parent().find(".msgBody").html().replace(/\s+/g, " ").trim() + "</textarea>");
                $("#inboxDetails").show();
            });
            $(".list-reply").on("click", function () {
                var msgId_str = $(this).parents(".inboxRow").data("msg_id");
            });



            //behavior of inboxDetails div
            $("#inboxDetails #goback").click(function () {
                $("#inboxDetails").hide();
                $("#inboxList").show();
            });
            $("#inboxDetails #reply").on("click", function () {
                var msgId_str = $(this).parents("#inboxDetails").data("msg_id");
            });

        });
    </script>
</body>

</html>